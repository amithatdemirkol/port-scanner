import requests

class VulnerabilityChecker:
    def __init__(self, open_ports, services):
        self.open_ports = open_ports
        self.services = services

    def check_vulnerabilities(self):
        for port, service in zip(self.open_ports, self.services):
            print(f"Checking vulnerabilities for {service} on port {port}")
            response = requests.get(f"https://cve.circl.lu/api/search/{service}")
            if response.status_code == 200:
                vulnerabilities = response.json()
                if vulnerabilities:
                    print(f"Found vulnerabilities for {service} on port {port}:")
                    for vuln in vulnerabilities[:5]:
                        print(f"{vuln['id']}: {vuln['summary']}")
                else:
                    print(f"No vulnerabilities found for {service} on port {port}")
            else:
                print(f"Error fetching vulnerabilities for {service}")
